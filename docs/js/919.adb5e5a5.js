"use strict";(globalThis["webpackChunkroster_builder"]=globalThis["webpackChunkroster_builder"]||[]).push([[919],{7919:(t,e,i)=>{i.r(e),i.d(e,{default:()=>pt});var n=i(9835),o=i(6970);const s=t=>((0,n.dD)("data-v-1c4d0815"),t=t(),(0,n.Cn)(),t),r={class:"q-gutter-x-sm print-hide"},a={class:"schedule track",id:"schedule"},l={class:"time-slots track full-track"},d=s((()=>(0,n._)("div",{class:"line"},null,-1))),u={class:"title text-h5 q-pt-sm"},c={class:"tracks"},m={class:"slot-header flex row justify-end print-hide"},h={class:"slot-content"};function v(t,e,i,s,v,p){const f=(0,n.up)("q-btn"),g=(0,n.up)("q-page");return(0,n.wg)(),(0,n.j4)(g,null,{default:(0,n.w5)((()=>[(0,n._)("div",r,[(0,n.Wm)(f,{icon:"add",onClick:t.onAdd,class:"q-mt-sm",round:"",color:"primary"},null,8,["onClick"]),(0,n.Wm)(f,{icon:"print",onClick:t.doPrint,class:"q-mt-sm",round:"",color:"primary"},null,8,["onClick"])]),(0,n._)("div",a,[(0,n._)("div",l,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(t.timeBlocks.filter((t=>0===t.minute||30===t.minute)),(e=>((0,n.wg)(),(0,n.iD)("div",{key:e.toKey(),class:"time-slot",style:(0,o.j5)({"grid-row":`time-${e.toKey()} / time-${t.nextBlock(e).toKey()}`})},[d,(0,n.Uk)(" "+(0,o.zw)(e),1)],4)))),128))]),((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(t.schedule.days,((e,i)=>((0,n.wg)(),(0,n.iD)("div",{class:"day-track full-track",key:e.name},[(0,n._)("div",u,(0,o.zw)(e.name),1),(0,n._)("div",c,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(e.getTracks(),(s=>((0,n.wg)(),(0,n.iD)("div",{class:"track",key:s.id},[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(s.getSlots(),(r=>((0,n.wg)(),(0,n.iD)("div",{key:r.id,class:"slot",style:(0,o.j5)({"grid-row":`time-${r.start.toKey()} / time-${r.end.toKey()}`})},[(0,n._)("div",m,[(0,n.Wm)(f,{icon:"edit",size:"sm",round:"",flat:"",onClick:()=>t.onEdit(r,i)},null,8,["onClick"]),(0,n.Wm)(f,{icon:"delete",size:"sm",round:"",flat:"",onClick:()=>t.removeSlot(e,s,r)},null,8,["onClick"])]),(0,n._)("div",h,[(0,n._)("div",null,(0,o.zw)(r.eventName),1),(0,n._)("div",null,(0,o.zw)(r.location),1),(0,n._)("div",null,(0,o.zw)(r.persons),1)])],4)))),128))])))),128))])])))),128))])])),_:1})}var p=i(1809),f=i(499),g=i(4308);class w{constructor(t,e={}){this.slotsIntersect=(t,e)=>!(!t.start.isBefore(e.start)||!t.end.isAfter(e.end))||(!(!t.start.isAfter(e.start)||!t.end.isBefore(e.end))||(!(!t.start.isBefore(e.start)||!t.end.isAfter(e.start))||!(!t.start.isBefore(e.end)||!t.end.isAfter(e.start)))),this.slotFits=(t,e)=>void 0===Object.values(e.slots).find((e=>this.slotsIntersect(e,t))),this.findTrackForSlot=t=>this.getTracks().find((e=>this.slotFits(t,e))),this.findTrackOrCreate=t=>this.findTrackForSlot(t)||this.addTrack(),this.addSlot=t=>{const e=this.findTrackOrCreate(t);e.slots[t.id]=t},this.name=t,this.tracks=e}addTrack(){const t=(0,g.Z)(),e=new k(t);return this.tracks[t]=e,e}getTracks(){return Object.values(this.tracks)}}class k{constructor(t,e={}){this.id=t,this.slots=e}getSlots(){return Object.values(this.slots)}}class E{constructor(t,e,i,n,o,s){this.id=t,this.eventName=e,this.location=i,this.persons=n,this.start=o,this.end=s}}class y{constructor(t=0,e=0){this.minute=0,this.hour=0,this.addMinutes=t=>{this.hour+=Math.floor((this.minute+t)/60),this.minute=(this.minute+t)%60},this.toString=()=>`${this.hour}:${this.minute.toString().padStart(2,"0")}`,this.toKey=()=>`${this.hour.toString().padStart(2,"0")}${this.minute.toString().padStart(2,"0")}`,this.isBefore=t=>this.hour<t.hour||this.hour===t.hour&&this.minute<t.minute,this.isAfter=t=>this.hour>t.hour||this.hour===t.hour&&this.minute>t.minute,this.equals=t=>this.hour===t.hour&&this.minute===t.minute,this.hour=null!==t&&void 0!==t?t:8,this.minute=null!==e&&void 0!==e?e:30}static parse(t){const e=t.split(":");if(2!==e.length)throw Error("Invalid time format");const i=parseInt(e[0]),n=parseInt(e[1]);if(Number.isNaN(i)||Number.isNaN(n))throw Error("Invalid time value");if(i<0||i>23)throw new Error("Invalid hour value");if(n<0||n>59)throw new Error("Invalid minute value");return new y(i,n)}static minutesBetween(t,e){if(t.equals(e))return 0;if(t.isAfter(e))return this.minutesBetween(e,t);const i=e.hour-t.hour;return 60*i+e.minute-t.minute}static fromTime(t){return new y(t.hour,t.minute)}}const S=(0,p.Q_)("schedule",(()=>{const t=(0,f.iH)([new w("Maandag"),new w("Dinsdag"),new w("Woensdag"),new w("Donderdag"),new w("Vrijdag")]),e=(t,e,i,n,o)=>new E((0,g.Z)(),t,e,i,n,o),i=(e,i)=>{const n=t.value[e].findTrackForSlot(i);return void 0!==n?n:t.value[e].addTrack()},n=(e,i,n)=>{const o=t.value[e].tracks[i];o.slots[n.id]=n},o=e=>{for(let i=0;i<t.value.length;i++){const n=t.value[i].getTracks().find((t=>void 0!==t.slots[e.id]));if(void 0!==n)return n}};return{days:t,createSlot:e,getTrack:i,addSlot:n,findTrack:o}}),{persist:{afterRestore:t=>{const e=t.store.days,i=e.map((t=>{const e={};return Object.values(t.tracks).forEach((t=>{const i={};Object.values(t.slots).forEach((t=>{const e=new E(t.id,t.eventName,t.location,t.persons,new y(t.start.hour,t.start.minute),new y(t.end.hour,t.end.minute));i[e.id]=e}));const n=new k(t.id,i);e[n.id]=n})),new w(t.name,e)}));t.store.days=i}}});var x=i(1957);const b=t=>((0,n.dD)("data-v-93426db4"),t=t(),(0,n.Cn)(),t),_={class:"text-h4",style:{overflow:"hidden"}},W={class:"row items-center justify-between no-wrap q-gutter-x-md"},q={class:"row items-center"},j=b((()=>(0,n._)("span",null,"Begintijd",-1))),C={class:"row items-center"},V=b((()=>(0,n._)("span",null,"Eindtijd",-1)));function Z(t,e,i,s,r,a){const l=(0,n.up)("q-card-section"),d=(0,n.up)("q-input"),u=(0,n.up)("q-tab"),c=(0,n.up)("q-tabs"),m=(0,n.up)("q-space"),h=(0,n.up)("q-btn"),v=(0,n.up)("q-time"),p=(0,n.up)("q-popup-proxy"),f=(0,n.up)("q-icon"),g=(0,n.up)("q-form"),w=(0,n.up)("q-card"),k=(0,n.up)("q-dialog"),E=(0,n.Q2)("close-popup");return(0,n.wg)(),(0,n.j4)(k,{id:"dialog",ref:"dialog",onHide:e[8]||(e[8]=()=>t.$emit("hide")),persistent:""},{default:(0,n.w5)((()=>[(0,n.Wm)(w,{style:{width:"50%","min-width":"500px","max-width":"unset"}},{default:(0,n.w5)((()=>[(0,n.Wm)(l,{id:"title-section"},{default:(0,n.w5)((()=>[(0,n._)("div",_,(0,o.zw)(t.existingEvent?"Event bewerken":"Nieuw event"),1)])),_:1}),(0,n.Wm)(g,{onSubmit:(0,x.iM)(t.onSave,["prevent"])},{default:(0,n.w5)((()=>[(0,n.Wm)(l,{class:"q-gutter-y-sm"},{default:(0,n.w5)((()=>{var i,o,s;return[(0,n.Wm)(d,{autofocus:"",filled:"",modelValue:t.formEvent.name,"onUpdate:modelValue":e[0]||(e[0]=e=>t.formEvent.name=e),placeholder:null===(i=t.existingEvent)||void 0===i?void 0:i.name,label:"Wat *","stack-label":"","lazy-rules":"",rules:[e=>{var i;return!!(null===(i=t.existingEvent)||void 0===i?void 0:i.name)||e&&e.length>0||"Veld is verplicht"}]},null,8,["modelValue","placeholder","rules"]),(0,n.Wm)(d,{filled:"",modelValue:t.formEvent.location,"onUpdate:modelValue":e[1]||(e[1]=e=>t.formEvent.location=e),placeholder:null===(o=t.existingEvent)||void 0===o?void 0:o.location,label:"Waar *","stack-label":"","lazy-rules":"",rules:[e=>{var i;return!!(null===(i=t.existingEvent)||void 0===i?void 0:i.location)||e&&e.length>0||"Veld is verplicht"}]},null,8,["modelValue","placeholder","rules"]),(0,n.Wm)(d,{filled:"",modelValue:t.formEvent.host,"onUpdate:modelValue":e[2]||(e[2]=e=>t.formEvent.host=e),placeholder:null===(s=t.existingEvent)||void 0===s?void 0:s.host,label:"Door wie *","stack-label":"","lazy-rules":"",rules:[e=>{var i;return!!(null===(i=t.existingEvent)||void 0===i?void 0:i.host)||e&&e.length>0||"Veld is verplicht"}]},null,8,["modelValue","placeholder","rules"]),(0,n.Wm)(c,{modelValue:t.formEvent.dayIndex,"onUpdate:modelValue":e[3]||(e[3]=e=>t.formEvent.dayIndex=e),dense:"",class:"text-grey","active-color":"primary","indicator-color":"primary",align:"justify","narrow-indicator":""},{default:(0,n.w5)((()=>[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(t.schedule.days,((t,e)=>((0,n.wg)(),(0,n.j4)(u,{key:e,name:e,label:t.name},null,8,["name","label"])))),128))])),_:1},8,["modelValue"]),(0,n._)("div",W,[(0,n.Wm)(d,{prefix:"Begint om",modelValue:t.formEvent.timeStart,"onUpdate:modelValue":e[5]||(e[5]=e=>t.formEvent.timeStart=e),dense:"",rules:[t.validateTime,()=>t.validateBefore(t.formEvent.timeStart,t.formEvent.timeEnd),()=>t.validateAfter(t.formEvent.timeEnd,t.formEvent.timeStart),t.validateDuration],"reactive-rules":""},{append:(0,n.w5)((()=>[(0,n.Wm)(f,{name:"access_time",class:"cursor-pointer"},{default:(0,n.w5)((()=>[(0,n.Wm)(p,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:(0,n.w5)((()=>[(0,n.Wm)(v,{modelValue:t.formEvent.timeStart,"onUpdate:modelValue":e[4]||(e[4]=e=>t.formEvent.timeStart=e),"hour-options":[8,9,10,11,12,13,14,15,16,17]},{default:(0,n.w5)((()=>[(0,n._)("div",q,[j,(0,n.Wm)(m),(0,n.wy)((0,n.Wm)(h,{label:"Ok",color:"primary",flat:""},null,512),[[E]])])])),_:1},8,["modelValue"])])),_:1})])),_:1})])),_:1},8,["modelValue","rules"]),(0,n.Wm)(d,{prefix:"Eindigt om",modelValue:t.formEvent.timeEnd,"onUpdate:modelValue":e[7]||(e[7]=e=>t.formEvent.timeEnd=e),dense:"",rules:["time",t.validateTime]},{append:(0,n.w5)((()=>[(0,n.Wm)(f,{name:"access_time",class:"cursor-pointer"},{default:(0,n.w5)((()=>[(0,n.Wm)(p,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:(0,n.w5)((()=>[(0,n.Wm)(v,{modelValue:t.formEvent.timeEnd,"onUpdate:modelValue":e[6]||(e[6]=e=>t.formEvent.timeEnd=e),"hour-options":[8,9,10,11,12,13,14,15,16,17]},{default:(0,n.w5)((()=>[(0,n._)("div",C,[V,(0,n.Wm)(m),(0,n.wy)((0,n.Wm)(h,{label:"Ok",color:"primary",flat:""},null,512),[[E]])])])),_:1},8,["modelValue"])])),_:1})])),_:1})])),_:1},8,["modelValue","rules"])])]})),_:1}),(0,n.Wm)(l,{id:"action-section",class:"row q-gutter-x-sm q-pt-xl"},{default:(0,n.w5)((()=>[(0,n.Wm)(h,{outline:"",icon:"close",label:"Sluiten",onClick:t.hide},null,8,["onClick"]),(0,n.Wm)(m),t.existingEvent?((0,n.wg)(),(0,n.j4)(h,{key:0,icon:"save",color:"primary",label:"Opslaan",type:"submit"})):((0,n.wg)(),(0,n.j4)(h,{key:1,icon:"add",color:"primary",label:"Toevoegen",type:"submit"}))])),_:1})])),_:1},8,["onSubmit"])])),_:1})])),_:1},512)}class I{constructor(t,e,i,n,o,s){this.name=t,this.location=e,this.host=i,this.timeStart=n,this.timeEnd=o,this.dayIndex=s}}I.fromSlot=(t,e)=>new I(t.eventName,t.location,t.persons,t.start.toString(),t.end.toString(),e),I.fromEvent=t=>new I(t.name,t.location,t.host,t.timeStart,t.timeEnd,t.dayIndex);const T=(0,n.aZ)({name:"AddSlotDialog",emits:["ok","hide"],props:{existingEvent:{type:Object,required:!1}},setup(t){var e,i,n,o,s,r,a,l,d,u,c,m;const h=S();return{schedule:h,formEvent:(0,f.iH)(new I(null!==(i=null===(e=t.existingEvent)||void 0===e?void 0:e.name)&&void 0!==i?i:"",null!==(o=null===(n=t.existingEvent)||void 0===n?void 0:n.location)&&void 0!==o?o:"",null!==(r=null===(s=t.existingEvent)||void 0===s?void 0:s.host)&&void 0!==r?r:"",null!==(l=null===(a=t.existingEvent)||void 0===a?void 0:a.timeStart)&&void 0!==l?l:"08:00",null!==(u=null===(d=t.existingEvent)||void 0===d?void 0:d.timeEnd)&&void 0!==u?u:"17:00",null!==(m=null===(c=t.existingEvent)||void 0===c?void 0:c.dayIndex)&&void 0!==m?m:0))}},methods:{show(){this.dialogComponent.show()},hide(){this.dialogComponent.hide()},onSave(){this.existingEvent&&(this.formEvent.name=this.formEvent.name?this.formEvent.name:this.existingEvent.name,this.formEvent.location=this.formEvent.location?this.formEvent.location:this.existingEvent.location,this.formEvent.host=this.formEvent.host?this.formEvent.host:this.existingEvent.host),this.$emit("ok",I.fromEvent(this.formEvent)),this.hide()},validateTime(t){try{const e=y.parse(t);return!(e.hour<8||e.hour>17)||"Kies een tijd tussen 08:00 en 17:59"}catch(e){return"Ongeldig formaat, HH:MM"}},validateBefore(t,e){try{const i=y.parse(t),n=y.parse(e);return!!i.isBefore(n)||"Beginttijd is voor eindtijd"}catch(i){return!1}},validateAfter(t,e){try{const i=y.parse(t),n=y.parse(e);return!!i.isAfter(n)||"Eindtijd is na begintijd"}catch(i){return!1}},validateDuration(){try{const t=y.parse(this.formEvent.timeStart),e=y.parse(this.formEvent.timeEnd);return!(y.minutesBetween(t,e)<30)||"Minimum tijd is 30 minuten"}catch(t){return!1}}},computed:{dialogComponent(){return this.$refs["dialog"]}}});var D=i(1639),Q=i(7743),$=i(4458),B=i(3190),O=i(8326),z=i(7471),N=i(2230),H=i(900),K=i(2857),M=i(9133),A=i(1086),P=i(136),U=i(1290),F=i(2146),R=i(9984),L=i.n(R);const Y=(0,D.Z)(T,[["render",Z],["__scopeId","data-v-93426db4"]]),J=Y;L()(T,"components",{QDialog:Q.Z,QCard:$.Z,QCardSection:B.Z,QForm:O.Z,QInput:z.Z,QTabs:N.Z,QTab:H.Z,QIcon:K.Z,QPopupProxy:M.Z,QTime:A.Z,QSpace:P.Z,QBtn:U.Z}),L()(T,"directives",{ClosePopup:F.Z});var G=i(8401);const X={class:"text-h5 text-bold q-pt-md"},tt={class:"text-body1 q-pt-md"},et={class:"flex row q-gutter-x-sm q-pt-lg"};function it(t,e,i,s,r,a){const l=(0,n.up)("q-checkbox"),d=(0,n.up)("q-space"),u=(0,n.up)("q-btn"),c=(0,n.up)("q-form"),m=(0,n.up)("q-card-section"),h=(0,n.up)("q-card"),v=(0,n.up)("q-dialog");return(0,n.wg)(),(0,n.j4)(v,{id:"dialog",ref:"dialog",onHide:e[1]||(e[1]=()=>t.$emit("hide"))},{default:(0,n.w5)((()=>[(0,n.Wm)(h,{style:{width:"40%","min-width":"400px","max-width":"unset"}},{default:(0,n.w5)((()=>[(0,n.Wm)(m,null,{default:(0,n.w5)((()=>[(0,n.Wm)(c,{autofocus:"",onSubmit:(0,x.iM)(t.ok,["prevent"])},{default:(0,n.w5)((()=>[(0,n._)("div",X,(0,o.zw)(t.title),1),(0,n._)("div",tt,(0,o.zw)(t.text),1),(0,n._)("div",et,[t.skipId?((0,n.wg)(),(0,n.j4)(l,{key:0,modelValue:t.noSkip,"onUpdate:modelValue":e[0]||(e[0]=e=>t.noSkip=e),label:"Niet meer vragen",dense:""},null,8,["modelValue"])):(0,n.kq)("",!0),(0,n.Wm)(d),(0,n.Wm)(u,{flat:"",label:"Nee",onClick:t.hide},null,8,["onClick"]),(0,n.Wm)(u,{color:"primary",label:"Ja",type:"submit"})])])),_:1},8,["onSubmit"])])),_:1})])),_:1})])),_:1},512)}const nt=(0,p.Q_)("confirm-skip",(()=>{const t=(0,f.iH)({}),e=e=>!0===t.value[e],i=(e,i=!0)=>{t.value[e]=i};return{skips:t,hasSkip:e,setSkip:i}}),{persist:!1}),ot=(0,n.aZ)({name:"ConfirmDialog",emits:["ok","hide"],props:{title:{type:String,default:"Let op!"},text:{type:String,default:"Weet je het zeker?"},skipId:{type:Object,default:void 0}},setup(){const t=nt();return{skipStore:t,noSkip:(0,f.iH)(!1)}},methods:{show(){this.dialogComponent.show()},hide(){this.dialogComponent.hide()},ok(){!0===this.noSkip&&this.skipId&&this.skipStore.setSkip(this.skipId,!0),this.$emit("ok"),this.hide()}},computed:{dialogComponent(){return this.$refs["dialog"]}}});var st=i(1221);const rt=(0,D.Z)(ot,[["render",it]]),at=rt;L()(ot,"components",{QDialog:Q.Z,QCard:$.Z,QCardSection:B.Z,QForm:O.Z,QCheckbox:st.Z,QSpace:P.Z,QBtn:U.Z});var lt=function(t,e,i,n){function o(t){return t instanceof i?t:new i((function(e){e(t)}))}return new(i||(i=Promise))((function(i,s){function r(t){try{l(n.next(t))}catch(e){s(e)}}function a(t){try{l(n["throw"](t))}catch(e){s(e)}}function l(t){t.done?i(t.value):o(t.value).then(r,a)}l((n=n.apply(t,e||[])).next())}))};const dt=(0,n.aZ)({name:"IndexPage",setup(){const t=S(),e=nt();return(0,G.Z)((()=>({title:"Rooster LIV"}))),{schedule:t,skipStore:e}},methods:{doPrint(){window.print()},onAdd(){this.$q.dialog({component:J}).onOk((t=>{const e=this.schedule.createSlot(t.name.trim(),t.location.trim(),t.host.trim(),y.parse(t.timeStart),y.parse(t.timeEnd)),i=this.schedule.getTrack(t.dayIndex,e);this.schedule.addSlot(t.dayIndex,i.id,e)}))},onEdit(t,e){this.$q.dialog({component:J,componentProps:{existingEvent:I.fromSlot(t,e)}}).onOk((i=>lt(this,void 0,void 0,(function*(){const n=this.schedule.findTrack(t);if(void 0===n)return void console.error(`Cannot find track for '${t.id}'.`);yield this.removeSlot(this.schedule.days[e],n,t,!0);const o=this.schedule.createSlot(i.name.trim(),i.location.trim(),i.host.trim(),y.parse(i.timeStart),y.parse(i.timeEnd)),s=this.schedule.getTrack(i.dayIndex,o);this.schedule.addSlot(i.dayIndex,s.id,o)}))))},removeSlot(t,e,i,n=!1){return lt(this,void 0,void 0,(function*(){const o="CONFIRM_REMOVE_SLOT";n||this.skipStore.hasSkip(o)||(yield new Promise(((e,n)=>this.$q.dialog({component:at,componentProps:{text:`Weet je zeker dat je '${i.eventName}' op ${t.name.toLocaleLowerCase()} wilt verwijderen?`,skipId:o}}).onOk(e).onCancel(n)))),delete e.slots[i.id],0===Object.values(e.slots).length&&delete t.tracks[e.id]}))},nextBlock(t){const e=new y(t.hour,t.minute);return e.addMinutes(30),e}},computed:{timeBlocks(){const t=1,e=new y(8,0),i=[];while(e.hour<=17)i.push(new y(e.hour,e.minute)),e.addMinutes(t);return i},cssData(){const t=140,e=document.getElementById("schedule");return{templateRows:this.timeBlocks.map((t=>`[time-${t.toKey()}] 1fr`)).join(" "),trackWidth:`${t}px`,lineSize:(80+this.schedule.days.map((e=>Math.max(150,e.getTracks().length*t))).reduce(((t,e)=>t+e),0)).toString()+"px",pageSize:`${null===e||void 0===e?void 0:e.offsetWidth}px ${null===e||void 0===e?void 0:e.offsetHeight}px landscape`}}}}),ut=()=>{(0,x.sj)((t=>({"08abeb55":t.cssData.pageSize,a3b721d0:t.cssData.templateRows,f429fbc0:t.cssData.trackWidth,"1c4afe3a":t.cssData.lineSize})))},ct=dt.setup;dt.setup=ct?(t,e)=>(ut(),ct(t,e)):ut;const mt=dt;var ht=i(9885);const vt=(0,D.Z)(mt,[["render",v],["__scopeId","data-v-1c4d0815"]]),pt=vt;L()(mt,"components",{QPage:ht.Z,QBtn:U.Z})}}]);