"use strict";(globalThis["webpackChunkroster_builder"]=globalThis["webpackChunkroster_builder"]||[]).push([[378],{378:(e,t,s)=>{s.r(t),s.d(t,{default:()=>G});var i=s(9835),a=s(6970);const o={class:"schedule track"},n={key:0,class:"line"},l={class:"title text-h5 q-pt-sm"},r={class:"tracks"},d={class:"slot-header flex row justify-end"},u={class:"slot-content"};function c(e,t,s,c,m,h){const p=(0,i.up)("q-btn"),w=(0,i.up)("q-page");return(0,i.wg)(),(0,i.j4)(w,null,{default:(0,i.w5)((()=>[(0,i.Wm)(p,{icon:"add",onClick:e.onAdd,class:"q-mt-sm print-hide",round:"",color:"primary"},null,8,["onClick"]),(0,i._)("div",o,[(0,i._)("div",{class:"time-slots track full-track",style:(0,a.j5)(e.CssGridTemplateRows)},[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(e.timeBlocks.filter((e=>0===e.minute||30===e.minute)),(t=>((0,i.wg)(),(0,i.iD)("div",{key:t.toKey(),class:"time-slot",style:(0,a.j5)({"grid-row":`time-${t.toKey()} / time-${e.nextBlock(t).toKey()}`})},[0===t.minute?((0,i.wg)(),(0,i.iD)("div",n)):(0,i.kq)("",!0),(0,i.Uk)(" "+(0,a.zw)(t),1)],4)))),128))],4),((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(e.schedule.days,(t=>((0,i.wg)(),(0,i.iD)("div",{class:"day-track full-track",key:t.name},[(0,i._)("div",l,(0,a.zw)(t.name),1),(0,i._)("div",r,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(t.getTracks(),(s=>((0,i.wg)(),(0,i.iD)("div",{class:"track",style:(0,a.j5)(e.CssGridTemplateRows),key:s.id},[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(s.getSlots(),(o=>((0,i.wg)(),(0,i.iD)("div",{key:o.id,class:"slot",style:(0,a.j5)({"grid-row":`time-${o.start.toKey()} / time-${o.end.toKey()}`})},[(0,i._)("div",d,[(0,i.Wm)(p,{icon:"delete",size:"sm",round:"",flat:"",onClick:()=>e.removeSlot(t,s,o)},null,8,["onClick"])]),(0,i._)("div",u,[(0,i._)("div",null,(0,a.zw)(o.eventName),1),(0,i._)("div",null,(0,a.zw)(o.location),1),(0,i._)("div",null,(0,a.zw)(o.persons),1)])],4)))),128))],4)))),128))])])))),128))])])),_:1})}var m=s(1809),h=s(499),p=s(4308);class w{constructor(e,t={}){this.slotsIntersect=(e,t)=>!(!e.start.isBefore(t.start)||!e.end.isAfter(t.end))||(!(!e.start.isAfter(t.start)||!e.end.isBefore(t.end))||(!(!e.start.isBefore(t.start)||!e.end.isAfter(t.start))||!(!e.start.isBefore(t.end)||!e.end.isAfter(t.start)))),this.slotFits=(e,t)=>void 0===Object.values(t.slots).find((t=>this.slotsIntersect(t,e))),this.findTrackForSlot=e=>this.getTracks().find((t=>this.slotFits(e,t))),this.findTrackOrCreate=e=>this.findTrackForSlot(e)||this.addTrack(),this.addSlot=e=>{const t=this.findTrackOrCreate(e);t.slots[e.id]=e},this.name=e,this.tracks=t}addTrack(){const e=(0,p.Z)(),t=new v(e);return this.tracks[e]=t,t}getTracks(){return Object.values(this.tracks)}}class v{constructor(e,t={}){this.id=e,this.slots=t}getSlots(){return Object.values(this.slots)}}class f{constructor(e,t,s,i,a,o){this.id=e,this.eventName=t,this.location=s,this.persons=i,this.start=a,this.end=o}}class g{constructor(e=0,t=0){this.minute=0,this.hour=0,this.addMinutes=e=>{this.hour+=Math.floor((this.minute+e)/60),this.minute=(this.minute+e)%60},this.toString=()=>`${this.hour}:${this.minute.toString().padStart(2,"0")}`,this.toKey=()=>`${this.hour.toString().padStart(2,"0")}${this.minute.toString().padStart(2,"0")}`,this.isBefore=e=>this.hour<e.hour||this.hour===e.hour&&this.minute<e.minute,this.isAfter=e=>this.hour>e.hour||this.hour===e.hour&&this.minute>e.minute,this.equals=e=>this.hour===e.hour&&this.minute===e.minute,this.hour=null!==e&&void 0!==e?e:8,this.minute=null!==t&&void 0!==t?t:30}static parse(e){const t=e.split(":");if(2!==t.length)throw Error("Invalid time format");const s=parseInt(t[0]),i=parseInt(t[1]);if(Number.isNaN(s)||Number.isNaN(i))throw Error("Invalid time value");if(s<0||s>23)throw new Error("Invalid hour value");if(i<0||i>59)throw new Error("Invalid minute value");return new g(s,i)}static minutesBetween(e,t){if(e.equals(t))return 0;if(e.isAfter(t))return this.minutesBetween(t,e);const s=t.hour-e.hour;return 60*s+t.minute-e.minute}}const k=(0,m.Q_)("schedule",(()=>{const e=(0,h.iH)([new w("Maandag"),new w("Dinsdag"),new w("Woensdag"),new w("Donderdag"),new w("Vrijdag")]),t=(e,t,s,i,a)=>new f((0,p.Z)(),e,t,s,i,a),s=(t,s)=>{const i=e.value[t].findTrackForSlot(s);return void 0!==i?i:e.value[t].addTrack()},i=(t,s,i)=>{const a=e.value[t].tracks[s];a.slots[i.id]=i};return{days:e,createSlot:t,getTrack:s,addSlot:i}}),{persist:{afterRestore:e=>{const t=e.store.days,s=t.map((e=>{const t={};return Object.values(e.tracks).forEach((e=>{const s={};Object.values(e.slots).forEach((e=>{const t=new f(e.id,e.eventName,e.location,e.persons,new g(e.start.hour,e.start.minute),new g(e.end.hour,e.end.minute));s[t.id]=t}));const i=new v(e.id,s);t[i.id]=i})),new w(e.name,t)}));e.store.days=s}}});var y=s(1957);const _=e=>((0,i.dD)("data-v-2a844837"),e=e(),(0,i.Cn)(),e),S=_((()=>(0,i._)("div",{class:"text-h4",style:{overflow:"hidden"}},"Nieuw event",-1))),b={class:"row items-center justify-between no-wrap q-gutter-x-md"},W={class:"row items-center"},V=_((()=>(0,i._)("span",null,"Begintijd",-1))),q={class:"row items-center"},T=_((()=>(0,i._)("span",null,"Eindtijd",-1)));function j(e,t,s,a,o,n){const l=(0,i.up)("q-card-section"),r=(0,i.up)("q-input"),d=(0,i.up)("q-select"),u=(0,i.up)("q-space"),c=(0,i.up)("q-btn"),m=(0,i.up)("q-time"),h=(0,i.up)("q-popup-proxy"),p=(0,i.up)("q-icon"),w=(0,i.up)("q-form"),v=(0,i.up)("q-card"),f=(0,i.up)("q-dialog"),g=(0,i.Q2)("close-popup");return(0,i.wg)(),(0,i.j4)(f,{id:"dialog",ref:"dialog",onHide:t[8]||(t[8]=()=>e.$emit("hide")),persistent:""},{default:(0,i.w5)((()=>[(0,i.Wm)(v,{style:{width:"50%","min-width":"500px","max-width":"unset"}},{default:(0,i.w5)((()=>[(0,i.Wm)(l,{id:"title-section"},{default:(0,i.w5)((()=>[S])),_:1}),(0,i.Wm)(w,{onSubmit:(0,y.iM)(e.onSave,["prevent"])},{default:(0,i.w5)((()=>[(0,i.Wm)(l,{class:"q-gutter-y-sm"},{default:(0,i.w5)((()=>[(0,i.Wm)(r,{filled:"",modelValue:e.eventName,"onUpdate:modelValue":t[0]||(t[0]=t=>e.eventName=t),label:"Wat *","lazy-rules":"",rules:[e=>e&&e.length>0||"Veld is verplicht"]},null,8,["modelValue","rules"]),(0,i.Wm)(r,{filled:"",modelValue:e.location,"onUpdate:modelValue":t[1]||(t[1]=t=>e.location=t),label:"Waar *","lazy-rules":"",rules:[e=>e&&e.length>0||"Veld is verplicht"]},null,8,["modelValue","rules"]),(0,i.Wm)(r,{filled:"",modelValue:e.name,"onUpdate:modelValue":t[2]||(t[2]=t=>e.name=t),label:"Door wie *","lazy-rules":"",rules:[e=>e&&e.length>0||"Veld is verplicht"]},null,8,["modelValue","rules"]),(0,i.Wm)(d,{modelValue:e.day,"onUpdate:modelValue":t[3]||(t[3]=t=>e.day=t),options:e.schedule.days.map(((e,t)=>t)),"option-label":t=>null===t?"":e.schedule.days[t].name,filled:""},null,8,["modelValue","options","option-label"]),(0,i._)("div",b,[(0,i.Wm)(r,{prefix:"Begint om",modelValue:e.timeStart,"onUpdate:modelValue":t[5]||(t[5]=t=>e.timeStart=t),dense:"",rules:[e.validateTime,()=>e.validateBefore(e.timeStart,e.timeEnd),()=>e.validateAfter(e.timeEnd,e.timeStart),e.validateDuration],"reactive-rules":""},{append:(0,i.w5)((()=>[(0,i.Wm)(p,{name:"access_time",class:"cursor-pointer"},{default:(0,i.w5)((()=>[(0,i.Wm)(h,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:(0,i.w5)((()=>[(0,i.Wm)(m,{modelValue:e.timeStart,"onUpdate:modelValue":t[4]||(t[4]=t=>e.timeStart=t),"hour-options":[8,9,10,11,12,13,14,15,16,17]},{default:(0,i.w5)((()=>[(0,i._)("div",W,[V,(0,i.Wm)(u),(0,i.wy)((0,i.Wm)(c,{label:"Ok",color:"primary",flat:""},null,512),[[g]])])])),_:1},8,["modelValue"])])),_:1})])),_:1})])),_:1},8,["modelValue","rules"]),(0,i.Wm)(r,{prefix:"Eindigt om",modelValue:e.timeEnd,"onUpdate:modelValue":t[7]||(t[7]=t=>e.timeEnd=t),dense:"",rules:["time",e.validateTime]},{append:(0,i.w5)((()=>[(0,i.Wm)(p,{name:"access_time",class:"cursor-pointer"},{default:(0,i.w5)((()=>[(0,i.Wm)(h,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:(0,i.w5)((()=>[(0,i.Wm)(m,{modelValue:e.timeEnd,"onUpdate:modelValue":t[6]||(t[6]=t=>e.timeEnd=t),"hour-options":[8,9,10,11,12,13,14,15,16,17]},{default:(0,i.w5)((()=>[(0,i._)("div",q,[T,(0,i.Wm)(u),(0,i.wy)((0,i.Wm)(c,{label:"Ok",color:"primary",flat:""},null,512),[[g]])])])),_:1},8,["modelValue"])])),_:1})])),_:1})])),_:1},8,["modelValue","rules"])])])),_:1}),(0,i.Wm)(l,{id:"action-section",class:"row q-gutter-x-sm q-pt-xl"},{default:(0,i.w5)((()=>[(0,i.Wm)(c,{outline:"",icon:"close",label:"Sluiten",onClick:e.hide},null,8,["onClick"]),(0,i.Wm)(u),(0,i.Wm)(c,{icon:"add",color:"primary",label:"Toevoegen",type:"submit"})])),_:1})])),_:1},8,["onSubmit"])])),_:1})])),_:1},512)}const B=(0,i.aZ)({name:"AddSlotDialog",emits:["ok","hide"],setup(){const e=k();return{schedule:e,name:(0,h.iH)(""),eventName:(0,h.iH)(""),location:(0,h.iH)(""),timeStart:(0,h.iH)("08:00"),timeEnd:(0,h.iH)("17:00"),day:(0,h.iH)(0)}},methods:{show(){this.dialogComponent.show()},hide(){this.dialogComponent.hide()},onSave(){const e=this.schedule.createSlot(this.eventName.trim(),this.location.trim(),this.name.trim(),g.parse(this.timeStart),g.parse(this.timeEnd)),t=this.schedule.getTrack(this.day,e);this.schedule.addSlot(this.day,t.id,e),this.$emit("ok",e),this.hide()},validateTime(e){try{const t=g.parse(e);return!(t.hour<8||t.hour>17)||"Kies een tijd tussen 08:00 en 17:59"}catch(t){return"Ongeldig formaat, HH:MM"}},validateBefore(e,t){try{const s=g.parse(e),i=g.parse(t);return!!s.isBefore(i)||"Beginttijd is voor eindtijd"}catch(s){return!1}},validateAfter(e,t){try{const s=g.parse(e),i=g.parse(t);return s.isAfter(i)}catch(s){return!1}},validateDuration(){try{const e=g.parse(this.timeStart),t=g.parse(this.timeEnd);return!(g.minutesBetween(e,t)<30)||"Minimum tijd is 30 minuten"}catch(e){return!1}}},computed:{dialogComponent(){return this.$refs["dialog"]}}});var C=s(1639),Z=s(7743),D=s(4458),E=s(3190),x=s(8326),Q=s(6611),H=s(4199),N=s(2857),I=s(2765),$=s(3326),A=s(136),K=s(4455),O=s(2146),z=s(9984),M=s.n(z);const U=(0,C.Z)(B,[["render",j],["__scopeId","data-v-2a844837"]]),F=U;M()(B,"components",{QDialog:Z.Z,QCard:D.Z,QCardSection:E.Z,QForm:x.Z,QInput:Q.Z,QSelect:H.Z,QIcon:N.Z,QPopupProxy:I.Z,QTime:$.Z,QSpace:A.Z,QBtn:K.Z}),M()(B,"directives",{ClosePopup:O.Z});const P=(0,i.aZ)({name:"IndexPage",setup(){const e=k();return{schedule:e}},methods:{onAdd(){this.$q.dialog({component:F})},removeSlot(e,t,s){delete t.slots[s.id],0===Object.values(t.slots).length&&delete e.tracks[t.id]},nextBlock(e){const t=new g(e.hour,e.minute);return t.addMinutes(30),t}},computed:{timeBlocks(){const e=1,t=new g(8,0),s=[];while(t.hour<=17)s.push(new g(t.hour,t.minute)),t.addMinutes(e);return s},CssGridTemplateRows(){return{"grid-template-rows":this.timeBlocks.map((e=>`[time-${e.toKey()}] 1fr`)).join(" ")}}}});var R=s(9885);const Y=(0,C.Z)(P,[["render",c],["__scopeId","data-v-04512a1c"]]),G=Y;M()(P,"components",{QPage:R.Z,QBtn:K.Z})}}]);